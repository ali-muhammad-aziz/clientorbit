trigger:
- main

pool:
  name: Default

variables:
  imageName: 'myapp'
  tag: 'latest'

steps:
- task: Docker@2
  displayName: 'Login to Docker Hub'
  inputs:
    command: login
    containerRegistry: 'DockerHub'

- task: Docker@2
  displayName: 'Build Docker Image'
  inputs:
    command: build
    Dockerfile: '**/Dockerfile'
    tags: |
      $(imageName):$(tag)

- task: Docker@2
  displayName: 'Push Docker Image'
  inputs:
    command: push
    tags: |
      $(imageName):$(tag)
